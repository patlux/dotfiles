#!/bin/sh

IMAGE="$(mktemp --tmpdir XXXX.png)"
ICON="$HOME/Pictures/images/icons/lock-blue.png"
read RES_X RES_Y <<<$(xdpyinfo | awk -F'[ x]+' '/dimensions:/{print $3, $4}')

# https://www.reddit.com/r/unixporn/comments/4yj29e/i3lock_simple_blur_script/?st=is21che7&sh=d753f314
# - NEW WAY -

ffmpeg \
  -f x11grab \
  -video_size "$RES_X"x"$RES_Y" \
  -y \
  -i $DISPLAY \
  -i $ICON \
  -filter_complex "boxblur=5:1,overlay=(main_w-overlay_w)/2:(main_h-overlay_h)/2" \
  -vframes 1 $IMAGE


# - OLD WAY -
  # ---------------------------------------------------------------------------- #
  # TAKE SCREENSHOT

  # scrot $IMAGE

  # ---------------------------------------------------------------------------- #
  # MANIPULATE IMAGE

  # #- GRAY EFFECT
  # gm mogrify \
  #   -colorspace gray \
  #   -scale 10% \
  #   -scale 1000% \
  #   $IMAGE

  # #- PLACE ICON
  # gm composite \
  #   -gravity center \
  #   $ICON $IMAGE $IMAGE




# ---------------------------------------------------------------------------- #
# CALL LOCKSCREEN

i3lock -i $IMAGE



# ---------------------------------------------------------------------------- #
# REMOVE IMAGE

rm $IMAGE
